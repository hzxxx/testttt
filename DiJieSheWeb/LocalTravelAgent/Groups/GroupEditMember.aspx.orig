<%@ Page Title="" Language="C#" MasterPageFile="~/LocalTravelAgent/LTA.master" AutoEventWireup="true"
    CodeFile="GroupEditMember.aspx.cs" Inherits="LocalTravelAgent_Groups_GroupEditMember" %>

<asp:Content ID="Content1" ContentPlaceHolderID="ContentPlaceHolder1" runat="Server">
    <script src="/Scripts/jquery.cookie.js" type="text/javascript"></script>
    <script src="/Scripts/jqueryplugin/jqueryui/js/jquery-ui-1.9.1.custom.min.js" type="text/javascript"></script>
    <link href="/Scripts/jqueryplugin/jqueryui/css/smoothness/jquery-ui-1.9.1.custom.min.css"
        rel="stylesheet" type="text/css" />
    <link href="/Scripts/jqueryplugin/tablesorter/style.css" rel="stylesheet" type="text/css" />
    <script src="/Scripts/jqueryplugin/jquery.tablesorter.js" type="text/javascript"></script>
    <script src="/Scripts/jqueryplugin/OrderIndex.js" type="text/javascript"></script>
    <script language="javascript" type="text/javascript">
        $(function () {

            var cookieName = "djsmetab";

            $("#tabs").tabs({
                active: $.cookie(cookieName),
                activate: function (event, ui) {
                    $.cookie(cookieName, ui.newTab.index(), { expires: 365 });
                }
            });
            $(".tablesorter").tablesorter();
            $(".IndexTable").orderIndex();
        });
    </script>
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder2" runat="Server">
    <div class="detail_titlebg">
        编辑人员
    </div>
    <div class="navstate">
        <a runat="server" id="a_link_1" href="/LocalTravelAgent/Groups/GroupEditBasicInfo.aspx">修改基本信息</a>一<a runat="server" id="a_link_2" href="/LocalTravelAgent/Groups/GroupEditMember.aspx" class="selectstate">修改成员信息</a>一<a runat="server" id="a_link_3" href="/LocalTravelAgent/Groups/GroupEditRoute.aspx">修改行程信息</a>
    </div>
    <div style="clear:both">
    </div>
    <h3 style="margin-left:15px;">
        <b>
            <%=CurrentGroup.Name %>游客列表</b></h3>
    <div class="box">
        提供三种录入线路的方式.您可以根据需要,选择其中的一种.</div>
    <div id="tabs">
        <ul>
            <li><a href="#tabs-1">直接录入</a></li>
            <li><a href="#tabs-2">文本录入</a></li>
            <li><a href="#tabs-3">Excel导入</a></li>
        </ul>
        <div id="tabs-1">
            <asp:Repeater runat="server" ID="rptMembers" OnItemCommand="rptMembers_ItemCommand">
                <HeaderTemplate>
                    <table class="tablesorter IndexTable" style="margin:0px">
        </table>
                    <table class="tablesorter InfoTable" style="width:650px;margin:0px;margin-top:2px">
                        <thead>
                        <tr>
                            <td>
                                类型
                            </td>
                            <td>
                                姓名
                            </td>
                            <td>
                                证件号码
                            </td>
                            <td>
                                联系电话
                            </td>
                            <td>
                                修改
                            </td>
                        </tr>
                        </thead>
                        <tbody>
                </HeaderTemplate>
                <ItemTemplate>
                    <tr>
                        <td>
                            <%#Eval("MemberType") %>
                        </td>
                        <td>
                            <%#Eval("RealName")%>
                        </td>
                        <td>
                            <%#Eval("IdCardNo")%><%#Eval("SpecialCardNo")%>
                        </td>
                        <td>
                            <%#Eval("PhoneNum")%>
                        </td>
                        <td>
                            <asp:Button runat="server" ID="btnModifyMember" CommandArgument='<%#Eval("Id") %>'
                                CommandName="Edit" Text="修改" />
                        </td>
                    </tr>
                </ItemTemplate>
                <FooterTemplate>
                    </tbody></table>
                </FooterTemplate>
            </asp:Repeater>
            <asp:Button runat="server" ID="btnAddMember" OnClick="btnAddMember_Click" Text="增加成员" CssClass="btn" style="margin-top:15px" />
            <asp:Panel runat="server" ID="pnlMemberEdit" Visible="false">
                <fieldset>
                    <legend></legend>
                    <table class="comTable">
                        <tr>
                            <td>
                                类型
                            </td>
                            <td>
<<<<<<< HEAD
                                <asp:RadioButtonList runat="server" ID="rblMemberType" RepeatDirection="Horizontal" class="clearborder">
=======
                                <asp:RadioButtonList runat="server" ID="rblMemberType" RepeatDirection="Horizontal">
>>>>>>> 5e25809290afa3f090b6a62282a7ea494b5f88dd
                                    <asp:ListItem Value="1">成人游客</asp:ListItem>
                                    <asp:ListItem Value="2">儿童</asp:ListItem>
                                    <asp:ListItem Value="3">外宾</asp:ListItem>
                                    <asp:ListItem Value="4">港澳台</asp:ListItem>
                                </asp:RadioButtonList>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                姓名
                            </td>
                            <td>
                                <asp:TextBox runat="server" ID="tbxName"></asp:TextBox>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                身份证号码
                            </td>
                            <td>
                                <asp:TextBox runat="server" ID="tbxIdCardNo"></asp:TextBox>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                其他证件号码
                            </td>
                            <td>
                                <asp:TextBox runat="server" ID="tbxSpecialCardNo"></asp:TextBox>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                联系电话
                            </td>
                            <td>
                                <asp:TextBox runat="server" ID="tbxPhone"></asp:TextBox>
                            </td>
                        </tr>
                    </table>
                    <asp:Button runat="server" OnClick="btnSaveMember_Click" ID="btnSave" Text="保存" CssClass="btn" />
                    <asp:Button ID="BtnCanel" runat="server" Text="取消" CssClass="btn" />
                </fieldset>
            </asp:Panel>
        </div>
        <div id="tabs-2">
            <p>
                将游客信息按照一定的格式输入,一次性导入系统
            </p>
            <p>
                <div>
                    格式要求:</div>
                <div>
                    1)单个游客的资料用逗号分隔,按序依次为:<strong>成员类型,姓名,证件号码(身份证或者其他有效证件),联系电话</strong>.如果没有对应信息,则留空.</div>
                <div>
                    2)成员类型必须是以下几种:<strong>成人游客,儿童,外宾,港澳台,导游,司机</strong> 不同游客用回车分隔. 比如:</div>
                <ul>
                    <li>成人游客,张晓华,51332919880321639X,13287839485</li>
                    <li>外宾,Jim Green,CH1034123,13287839485</li>
                    <li>儿童,李晓彤</li>
                </ul>
            </p>
            <asp:TextBox TextMode="MultiLine" runat="server" ID="tbxSimple" CssClass="tbMemberSingleText" style="width:97%"></asp:TextBox>
            <asp:Button runat="server" ID="btnSaveSimple" OnClick="btnSave_Click" OnClientClick="javascript:return confirm('原有的团队成员信息将清除,是否继续?');"
                Text="保存" CssClass="btn" />
            <asp:Label runat="server" ID="lblSimpleMsg" ForeColor="green"></asp:Label>
        </div>
        <div id="tabs-3">
            <p>
                将游客信息从的Excel文件中导进系统.请下载模板文件,按照规范填入数据.</p>
            <p>
                <a href="">Excel模板文件下载</a>
            </p>
            <asp:TextBox TextMode="MultiLine" runat="server" ID="tbxExcel" CssClass="tbMemberSingleText" style="width:97%"></asp:TextBox>
            <p>
                <asp:FileUpload runat="server" ID="fuMemberExcel" />
                <asp:Button ID="btnUpload" runat="server" Text="上传" OnClick="btnUpload_Click" CssClass="btn" />
                <asp:Label ID="Label1" runat="server" />
                <asp:Button runat="server" ID="Button1" OnClick="btnExcel_Click" CssClass="btn" OnClientClick="javascript:return confirm('原有的团队成员信息将清除,是否继续?');"
                    Text="保存" />
            </p>
        </div>
    </div>
</asp:Content>
